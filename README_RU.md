# ESP-IDF Button Long Press Component

[![CI Status](https://github.com/maslennikov-yv/button_longpress/workflows/ESP-IDF%20Button%20Component%20CI/badge.svg)](https://github.com/maslennikov-yv/button_longpress/actions)
[![Test Coverage](https://img.shields.io/badge/coverage-80%25-green.svg)](https://github.com/maslennikov-yv/button_longpress/actions)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![ESP-IDF](https://img.shields.io/badge/ESP--IDF-v4.4%2B-blue.svg)](https://github.com/espressif/esp-idf)

–í—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã–π –∏ –Ω–∞–¥–µ–∂–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è ESP-IDF, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–∏–π —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –∫–Ω–æ–ø–æ–∫ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –¥–ª–∏—Ç–µ–ª—å–Ω–æ–≥–æ –Ω–∞–∂–∞—Ç–∏—è, –¥–≤–æ–π–Ω–æ–≥–æ –∫–ª–∏–∫–∞ –∏ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –¥—Ä–µ–±–µ–∑–≥–∞ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤.

## ‚ú® –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üîò **–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –¥–ª–∏—Ç–µ–ª—å–Ω–æ–≥–æ –Ω–∞–∂–∞—Ç–∏—è** - –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–æ–µ –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è
- üñ±Ô∏è **–î–≤–æ–π–Ω–æ–π –∫–ª–∏–∫** - –¥–µ—Ç–µ–∫—Ü–∏—è –±—ã—Å—Ç—Ä—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –Ω–∞–∂–∞—Ç–∏–π
- ‚ö° **–£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –¥—Ä–µ–±–µ–∑–≥–∞** - –∞–ø–ø–∞—Ä–∞—Ç–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ–º–µ—Ö
- üîÑ **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è** - callback-—Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ —Å–æ–±—ã—Ç–∏–π
- üõ°Ô∏è **–ü–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –∑–∞—â–∏—Ç–∞ –º—å—é—Ç–µ–∫—Å–∞–º–∏ –¥–ª—è –º–Ω–æ–≥–æ–∑–∞–¥–∞—á–Ω–æ—Å—Ç–∏
- üìä **–ö–æ–Ω–µ—á–Ω—ã–π –∞–≤—Ç–æ–º–∞—Ç** - –Ω–∞–¥–µ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–π
- üéõÔ∏è **–ì–∏–±–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –≤—Å–µ—Ö –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- üîå **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è** - —Ä–∞–±–æ—Ç–∞ —Å active-high –∏ active-low –∫–Ω–æ–ø–∫–∞–º–∏
- üíæ **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏** - –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
- üß™ **–ü–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - 80%+ –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –≤ –ø–∞–ø–∫—É `components` –≤–∞—à–µ–≥–æ ESP-IDF –ø—Ä–æ–µ–∫—Ç–∞:
```bash
cd your_project/components
git clone https://github.com/maslennikov-yv/button_longpress.git
```

2. –ò–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ –∫–∞–∫ git submodule:
```bash
git submodule add https://github.com/maslennikov-yv/button_longpress.git components/button_longpress
```

### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```c
#include "button_longpress.h"

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–±—ã—Ç–∏–π –∫–Ω–æ–ø–∫–∏
static void button_event_handler(button_event_t event)
{
    switch (event) {
        case BUTTON_EVENT_PRESSED:
            printf("–ö–Ω–æ–ø–∫–∞ –Ω–∞–∂–∞—Ç–∞\n");
            break;
        case BUTTON_EVENT_RELEASED:
            printf("–ö–Ω–æ–ø–∫–∞ –æ—Ç–ø—É—â–µ–Ω–∞\n");
            break;
        case BUTTON_EVENT_LONG_PRESS:
            printf("–î–ª–∏—Ç–µ–ª—å–Ω–æ–µ –Ω–∞–∂–∞—Ç–∏–µ!\n");
            break;
        case BUTTON_EVENT_DOUBLE_CLICK:
            printf("–î–≤–æ–π–Ω–æ–π –∫–ª–∏–∫!\n");
            break;
    }
}

void app_main(void)
{
    // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–Ω–æ–ø–∫–∏
    button_config_t btn_config = {
        .gpio_num = GPIO_NUM_0,           // GPIO –ø–∏–Ω
        .active_level = 0,                // –ê–∫—Ç–∏–≤–Ω—ã–π –Ω–∏–∑–∫–∏–π —É—Ä–æ–≤–µ–Ω—å
        .debounce_time_ms = 20,           // 20–º—Å —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –¥—Ä–µ–±–µ–∑–≥–∞
        .long_press_time_ms = 2000,       // 2 —Å–µ–∫—É–Ω–¥—ã –¥–ª—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ–≥–æ –Ω–∞–∂–∞—Ç–∏—è
        .double_click_time_ms = 300,      // 300–º—Å –¥–ª—è –¥–≤–æ–π–Ω–æ–≥–æ –∫–ª–∏–∫–∞
        .callback = button_event_handler  // –§—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞
    };
    
    // –°–æ–∑–¥–∞–Ω–∏–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –∫–Ω–æ–ø–∫–∏
    button_handle_t btn = button_create(&btn_config);
    if (btn == NULL) {
        printf("–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∫–Ω–æ–ø–∫–∏\n");
        return;
    }
    
    // –í–∞—à –∫–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∑–¥–µ—Å—å...
    
    // –û—á–∏—Å—Ç–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
    button_delete(btn);
}
